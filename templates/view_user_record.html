{% extends "base.html" %}

{% block title %}Chi tiết Nguồn thải{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Chi tiết Nguồn thải - {{ profile.name }}</h2>
        <a href="{{ url_for('view_user_profile_detail', profile_id=profile.id) }}" class="btn btn-secondary">Quay lại Profile</a>
    </div>

    <div class="card">
        <div class="card-header bg-info text-white">
            <h4 class="mb-0"><i class="fas fa-eye"></i> Chi tiết Bản ghi Phát thải</h4>
        </div>
        <div class="card-body">
            <div class="row">
                <!-- Thông tin cơ bản -->
                <div class="col-md-4">
                    <h6 class="text-primary mb-3"><i class="fas fa-info-circle"></i> Thông tin cơ bản</h6>
                    
                    <table class="table table-borderless">
                        <tr>
                            <td class="fw-bold">STT:</td>
                            <td>{{ record['STT'] }}</td>
                        </tr>
                        <tr>
                            <td class="fw-bold">Tên Nguồn thải:</td>
                            <td>{{ record['Tên Nguồn thải'] }}</td>
                        </tr>
                        <tr>
                            <td class="fw-bold">Lưu lượng:</td>
                            <td>{{ "{:,.2f}".format(record['Lưu lượng (Nm3/h)']) }} Nm³/h</td>
                        </tr>
                        <tr>
                            <td class="fw-bold">Thời gian:</td>
                            <td>{{ "{:,.2f}".format(record['Tổng thời gian xả thải trong kỳ (Giờ)']) }} giờ</td>
                        </tr>
                        <tr>
                            <td class="fw-bold">Đơn vị phân tích:</td>
                            <td>{{ record['Thông tin đơn vị Phân tích'] or 'N/A' }}</td>
                        </tr>
                        <tr>
                            <td class="fw-bold">Hệ số Kp:</td>
                            <td>{{ "{:,.2f}".format(record['Kp']) }}</td>
                        </tr>
                        <tr>
                            <td class="fw-bold">Hệ số Kv:</td>
                            <td>{{ "{:,.2f}".format(record['Kv']) }}</td>
                        </tr>
                    </table>
                </div>
                
                <!-- Nồng độ các chất -->
                <div class="col-md-4">
                    <h6 class="text-primary mb-3"><i class="fas fa-flask"></i> Nồng độ các chất</h6>
                    
                    <table class="table table-borderless">
                        <tr>
                            <td class="fw-bold">Bụi:</td>
                            <td>{{ "{:,.2f}".format(record['Bụi (mg/Nm3)']) }} mg/Nm³</td>
                        </tr>
                        <tr>
                            <td class="fw-bold">Tiêu chuẩn Bụi:</td>
                            <td>{{ "{:,.2f}".format(record['Tiêu chuẩn Bụi']) }} mg/Nm³</td>
                        </tr>
                        <tr>
                            <td class="fw-bold">NOx:</td>
                            <td>{{ "{:,.2f}".format(record['NOx (gồm NO2 và NO) (mg/Nm3)']) }} mg/Nm³</td>
                        </tr>
                        <tr>
                            <td class="fw-bold">Tiêu chuẩn NOx:</td>
                            <td>{{ "{:,.2f}".format(record['Tiêu chuẩn NOx']) }} mg/Nm³</td>
                        </tr>
                        <tr>
                            <td class="fw-bold">SOx:</td>
                            <td>{{ "{:,.2f}".format(record['SOx (mg/Nm3)']) }} mg/Nm³</td>
                        </tr>
                        <tr>
                            <td class="fw-bold">Tiêu chuẩn SOx:</td>
                            <td>{{ "{:,.2f}".format(record['Tiêu chuẩn SOx']) }} mg/Nm³</td>
                        </tr>
                        <tr>
                            <td class="fw-bold">CO:</td>
                            <td>{{ "{:,.2f}".format(record['CO (mg/Nm3)']) }} mg/Nm³</td>
                        </tr>
                        <tr>
                            <td class="fw-bold">Tiêu chuẩn CO:</td>
                            <td>{{ "{:,.2f}".format(record['Tiêu chuẩn CO']) }} mg/Nm³</td>
                        </tr>
                    </table>
                </div>
                
                <!-- Kết quả tính toán -->
                <div class="col-md-4">
                    <h6 class="text-primary mb-3"><i class="fas fa-calculator"></i> Kết quả tính toán</h6>
                    
                    <div class="mb-3">
                        <h6 class="text-secondary">Mức thu phí biến đổi</h6>
                        <table class="table table-sm table-striped">
                            <tr>
                                <td>Bụi:</td>
                                <td class="text-end">{{ record['Mức thu phí biến đổi của Bụi'] }}</td>
                            </tr>
                            <tr>
                                <td>NOx:</td>
                                <td class="text-end">{{ record['Mức thu phí biến đổi của Nox'] }}</td>
                            </tr>
                            <tr>
                                <td>SOx:</td>
                                <td class="text-end">{{ record['Mức thu phí biến đổi của Sox'] }}</td>
                            </tr>
                            <tr>
                                <td>CO:</td>
                                <td class="text-end">{{ record['Mức thu phí biến đổi của CO'] }}</td>
                            </tr>
                        </table>
                    </div>
                    
                    <div>
                        <h6 class="text-secondary">Giá trị Ci (VNĐ)</h6>
                        <table class="table table-sm table-striped">
                            <tr>
                                <td>Ci (Bụi):</td>
                                <td class="text-end">{{ "{:,.0f}".format(record['Ci (Bụi)']) }}</td>
                            </tr>
                            <tr>
                                <td>Ci (NOx):</td>
                                <td class="text-end">{{ "{:,.0f}".format(record['Ci (NOx)']) }}</td>
                            </tr>
                            <tr>
                                <td>Ci (SOx):</td>
                                <td class="text-end">{{ "{:,.0f}".format(record['Ci (SOx)']) }}</td>
                            </tr>
                            <tr>
                                <td>Ci (CO):</td>
                                <td class="text-end">{{ "{:,.0f}".format(record['Ci (CO)']) }}</td>
                            </tr>
                            <tr class="table-warning">
                                <td class="fw-bold">Tổng Ci:</td>
                                <td class="text-end fw-bold">{{ "{:,.0f}".format(record['Ci']) }}</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
